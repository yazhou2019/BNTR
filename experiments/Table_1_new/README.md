# Data
- We compare 4 methods in the main paper. The code are collected in this directory.
- The synthetic data is generated by "./BroadcasTR/20230918_generate_data_new_editor.R." You will obtain the synthetic data "Simul_n1000_rep50_final_fix_new_editor.Rdata", which is saved in "./BroadcasTR/SimResults". Remark: you need to set "./BroadcasTR" as the working directory.
- When you run methods (BroadcasTR, TLR-rescaled, ENetR), you need to put the generated data in the local file named "./SimResults".


# BroadcasTR
- Remark: you need to set "./BroadcasTR" as the working directory.
- See the file BroadcasTR. You can run SimNonLin.R and ISE_SimNonLin.R to obtain the fitting results and ISE, respectively. After you finish the codes, you will get "BNTR_500_20230918.Rdata", "BNTR_750_20230918.Rdata", "BNTR_1000_20230918.Rdata", "ise_BNTR_500_20230918.Rdata", "ise_BNTR_750_20230918.Rdata", and "ise_BNTR_1000_20230918.Rdata" in "./BroadcasTR/SimResults". Note that you can chose which sample size to run in SimNonLin.R. See below.
  ```
  
source('./ParallelComput/parallel_replications_big_1000K8_new.R') # when you want to run the situation where the sample size n=1000 

#source('./ParallelComput/parallel_replications_big_750K7_new.R') # when you want to run the situation where the sample size n=750

#source('./ParallelComput/parallel_replications_big_500K6_new.R') # when you want to run the situation where the sample size n=500
  ```

- The tuning parameters can be set in "./BroadcasTR/ParallelComput/parallel_source_1000.R" (for the sample size n=1000), "./BroadcasTR/ParallelComput/parallel_source_750.R" (for the sample size n=750), or "./BroadcasTR/ParallelComput/parallel_source_500.R" (for the sample size n=500). To be more specific, you can set the grids of tuning parameters in the file. 
```
# The following is a part of parallel_source_750.R

# The girds of the rank 
R=c(1,2,3,4,5)

# The grids of lambda_2
alpha=c(0,0.5,1)

# The grids of lambda_1
lambda=c(0.01,0.05,0.1,0.5,1,5,10,50,100,500,1000)


```

# TLR-rescaled
- See the file TLR-rescaled. You can run SimLin.R and ISE_SimLin.R to obtain the fitting results and ISE, respectively.

# ENetR
- See the file ENetR. You can run SimENetR.R and ISE_SimENetR.R to obtain the fitting results and ISE, respectively.

# TLR1 (The code depends on the MATLAB code in https://hua-zhou.github.io/TensorReg/)
- step 1: use Data_generation_to_MATLAB_new.R to transform the generated Rdata to .mat format.
- step 2: run (TLR_repeat_1000_grid.m, TLR_repeat_750_grid.m, TLR_repeat_500_grid.m) in MATLAB to obtain the fitting results.
- step 3: use mat2Rdata.R to transform the fitting results to .Rdata format.
- step 4: use parallel_get_ise_TLR1.R to obtain the ISE.



 



The code for the analyses presented in the paper is located in the "./experiments" directory.

There are a number of folders for figures and tables, please refer to the readme file in the previous level of the directory. For more implementation details, go to the corresponding folder for figures and tables and refer to the readme file. For example, you can go to Table_1_new and you will see a readme file where you can see more implementation details. 

(Example) The following is the readme file of Table_1_new. 
<details>
  <summary>Click to view collapsible paragraph---the readme file of Table_1_new </summary>
# Data
- We compare 4 methods in the main paper. The codes are collected in this directory.
- The synthetic data is generated by "./BroadcasTR/20230918_generate_data_new_editor.R." You will obtain the synthetic data "Simul_n1000_rep50_final_fix_new_editor.Rdata", which is saved in "./BroadcasTR/SimResults". Remark: you need to set "./BroadcasTR" as the working directory.
- When you run methods (BroadcasTR, TLR-rescaled, ENetR), you need to put the generated data in the local file named "./SimResults".


# BroadcasTR
- Remark0: you need to set "./BroadcasTR" as the working directory.
- See the file BroadcasTR. You can run SimNonLin.R and ISE_SimNonLin.R to obtain the fitting results and ISE, respectively. After you finish the codes, you will get "BNTR_500_20230918.Rdata", "BNTR_750_20230918.Rdata", "BNTR_1000_20230918.Rdata", "ise_BNTR_500_20230918.Rdata", "ise_BNTR_750_20230918.Rdata", and "ise_BNTR_1000_20230918.Rdata" in "./BroadcasTR/SimResults".

- Remark1: you can chose the sample size (n=500, 750 or 1000) for SimNonLin.R by directly replacing the code in SimNonLin.R. See below.
```
# The following is SimNonLin.R 
source('./ParallelComput/parallel_replications_big_1000K8_new.R') # when you want to run the experiment where the sample size n=1000 

#source('./ParallelComput/parallel_replications_big_750K7_new.R') # when you want to run the experiment where the sample size n=750

#source('./ParallelComput/parallel_replications_big_500K6_new.R') # when you want to run the experiment where the sample size n=500
```
- Remark2: you can chose the sample size (n=500, 750 or 1000) for ISE_SimNonLin.R by replacing the code in parallel_get_ise.R. See below. 
```
# The following is a part of ./BroadcasTR/ParallelComput/parallel_get_ise.R

#####
sfSource('./ParallelComput/parallel_source_500.R') #when you want to run the experiment where the sample size n=500. If you want to run the experiments for the sample size n=750 or n=1000, you can relace it by sfSource('./ParallelComput/parallel_source_750.R') or sfSource('./ParallelComput/parallel_source_1000.R').
#####
```


- The tuning parameters can be set in "./BroadcasTR/ParallelComput/parallel_source_1000.R" (for the sample size n=1000), "./BroadcasTR/ParallelComput/parallel_source_750.R" (for the sample size n=750), or "./BroadcasTR/ParallelComput/parallel_source_500.R" (for the sample size n=500). To be more specific, you can set the grids of tuning parameters in the file. 
```
# The following is a part of parallel_source_750.R

# The girds of the rank 
R=c(1,2,3,4,5)

# The grids of lambda_2
alpha=c(0,0.5,1)

# The grids of lambda_1
lambda=c(0.01,0.05,0.1,0.5,1,5,10,50,100,500,1000)
```

# TLR-rescaled
- Remark0: you need to set "./TLR-rescaled" as the working directory.
- See the file TLR-rescaled. You can run SimLin.R and ISE_SimLin.R to obtain the fitting results and ISE, respectively. After you finish the codes, you will get "TLR2_500_20230918.Rdata", "TLR2_750_20230918.Rdata", "TLR2_1000_20230918.Rdata", "ise_TLR2_500_20230918.Rdata", "ise_TLR2_750_20230918.Rdata", and "ise_TLR2_1000_20230918.Rdata" in "./TLR-rescaled/SimResults". Note that you need to run "mkdir SimResults" before running SimLin.R and ISE_SimLin.R in this directory. 

- Remark1: you can chose the sample size (n=500, 750 or 1000) for SimLin.R and ISE_SimLin.R by replacing the code in parallel_source_linear.R. See below.
```
### The following is a part of ./TLR-rescaled/ParallelComput/parallel_source_linear.R

n_use=1000 # when you want to run the experiment where the sample size n=1000. If you want to run the experiments fot the sample size n=500 or n=750, you can relace it by n_use = 500 or n_use = 750.
```


# ENetR
- Remark0: you need to set "./ENetR" as the working directory.
- See the file ENetR. You can run SimENetR.R and ISE_SimENetR.R to obtain the fitting results and ISE, respectively. After you finish the codes, you will get "ENet_500_20230918.Rdata", "ENet_750_20230918.Rdata", "ENet_1000_20230918.Rdata", "ise_ENet_500_20230918.Rdata", "ise_ENet_750_20230918.Rdata", and "ise_ENet_1000_20230918.Rdata" in "./ENetR/SimResults". Note that you need to run "mkdir SimResults" before running SimENetR.R and ISE_SimENetR.R in this directory.

- Remark1: you can chose the sample size (n=500, 750 or 1000) for SimENetR.R and ISE_SimENetR.R by replacing the code in ENet_source.R. See below.
```
### The following is a part of .ENetR/ENetComponents/ENet_source.R
n_use=750 #  when you want to run the experiment where the sample size n=750. If you want to run the experiments fot the sample size n=1000 or n=500, you can relace it by n_use = 1000 or n_use = 500.
```

# TLR1 (The code depends on the MATLAB code in https://hua-zhou.github.io/TensorReg/)
- step 1: use Data_generation_to_MATLAB_new.R to transform the generated Rdata to .mat format.
- step 2: run (TLR_repeat_1000_grid.m, TLR_repeat_750_grid.m, TLR_repeat_500_grid.m) in MATLAB to obtain the fitting results.
- step 3: use mat2Rdata.R to transform the fitting results to .Rdata format.
- step 4: use parallel_get_ise_TLR1.R to obtain the ISE.
 </details>


  
